## 1. Rasterizer

> rasterizingì˜ 5ë‹¨ê³„

- Clipping
- Perspective division
- Back-face culling
- Viewport transform
- Scan conversion

## 2. Clipping

Clipping is performed in the clip space.

View frustum ì•ˆì— ìˆëŠ” ë¶€ë¶„ë§Œ ë Œë”ë§.

ë©´ì„ í†µí•´ ì‚¼ê°í˜•ì„ ì˜ë¼ì„œ ìƒˆë¡œìš´ ì‚¼ê°í˜•ì„ ë§Œë“¦.

í•˜ë“œì›¨ì–´ì˜ ì˜ì—­

## 3. Perspective Division

$$
M_{proj}
=\begin{pmatrix}
\frac{\cot\frac{fov}{2}}{aspect} & 0 & 0 & 0 \\
0 &\cot\frac{fov}{2} & 0 & 0 \\
0 & 0 &-\frac{f+n}{f-n} & -\frac{2nf}{f-n}\\
0 &0 & -1 & 0
\end{pmatrix}
$$

â–¼ê°„ëµíˆ í‘œí˜„

$$
\begin{pmatrix}
m_{11} & 0 & 0 & 0 \\
0 & m_{22} & 0 & 0 \\
0 & 0 & m_{33} & m_{34} \\
0 & 0 & -1 & 0
\end{pmatrix}
\begin{pmatrix}
x \\
y \\
z \\
1
\end{pmatrix}
=\begin{pmatrix}
m_{11}x \\
m_{22}y \\
m_{33}z+m_{34} \\
-z
\end{pmatrix}
=\begin{pmatrix}
-\frac{m_{11}x}{z} \\
-\frac{m_{22}y}{z} \\
-m_{33}-\frac{m_{34}}{z} \\
1
\end{pmatrix}
$$

- -zì˜ ì˜ë¯¸: ì¢Œí‘œê°€ ì–¼ë§ˆë‚˜ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆëŠ”ì§€ë¥¼ ì˜ë¯¸í•œë‹¤.
  â†’ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆì„ ìˆ˜ë¡ ë” í° ê°’ìœ¼ë¡œ ì¢Œí‘œê°’ì„ ë‚˜ëˆ ì£¼ê¸° ë•Œë¬¸ì— clip spaceì—ì„œ í‘œí˜„ë˜ëŠ” ì¢Œí‘œê°€ ë” ì‘ì•„ì§

â†’ì›ê·¼ë²•ì„ í‘œí˜„í•˜ê¸° ìœ„í•œ ë‚˜ëˆ—ì…ˆ

## 4. Back-face Culling

- ë¬¼ì²´ì˜ ë³´ì´ì§€ ì•ŠëŠ” ë’·ë©´ì„ ì œê±°í•œë‹¤.
- if(ì‚¼ê°í˜•ì˜ í•œ ê¼­ì§€ì ê³¼ ì¹´ë©”ë¼ê¹Œì§€ì˜ ë²¡í„° â€¢ normal vector=0){
  ì‚¼ê°í˜•ì€ edge-on face
  } else if(ì‚¼ê°í˜•ì˜ í•œ ê¼­ì§€ì ê³¼ ì¹´ë©”ë¼ê¹Œì§€ì˜ ë²¡í„° â€¢ normal vector>0){
  ì‚¼ê°í˜•ì€ front face
  } else{
  back face
  }
  â‡’ê°œë…ì  ì´í•´
- ì‹¤ì œë¡œëŠ” spaceê°€ ê¸°ìš¸ì–´ì§€ì§€ ì•Šì•„ ê³„ì‚°ì´ ì¢€ ë” í¸í•˜ë‹¤.
- back faces are not always culled
  - ë°˜íˆ¬ëª…í•œ êµ¬ë¥¼ ê·¸ë¦°ë‹¤ë©´ back faceë„ ê·¸ë ¤ì ¸ì•¼ í•¨.
  - consider culling front faces: êµ¬ì˜ ë‹¨ë©´ì„ ë³´ê²Œ ë¨.
  - default value is GL_FALSE(back face cullingì„ í•˜ê² ë‹¤.)

## 5. Viewport Transform

- screen space is left-handed

ğŸ’¡ Review

`object space`â€”world transformâ€”â€”>`world space`â€”â€”view transformâ€”â€”>`camera space`â€”â€”projection transformâ€”>`clip space`â€”â€”viewport transformâ€”â€”>`screen space`

- clip spaceëŠ” NDC(2*2*2)ì˜ ì •ìœ¡ë©´ì²´, screen spaceëŠ” ì§ìœ¡ë©´ì²´

$$
\begin{pmatrix}
\frac{w}{2} & 0 & 0 & minX+\frac{w}{2} \\
0 & \frac{h}{2} & 0 minY+\frac{h}{2} \\
0 & 0 & \frac{maxZ-minZ}{2} & \frac{maxZ+minZ}{2} \\
0 & 0 & 0 & 1
\end{pmatrix}
$$

â†’viewport transform matrix

- In most applications, minZ and maxZ ar set to 0.0 and 1.0, and both of minX and minY are 0.

$$
\begin{pmatrix}
\frac{w}{2} & 0 & 0 & \frac{w}{2} \\
0 & \frac{h}{2} & 0 & \frac{h}{2} \\
0 & 0 & \frac{1}{2} & \frac{1}{2} \\
0 & 0 & 0 & 1
\end{pmatrix}
$$

ğŸ’¡ Review

```glsl
uniform mat3 worldMat, viewMat, projMat;

layout(location = 0) in vec3 position;
layout(location = 1) in vec3 normal;
layout(location = 2) in vec2 texCoord;

out vec3 v_normal;
out vec2 v_texCoord;

void main(){
	// object space to clip space
	gl_Position = projMat * viewMat * worldMat * vec4(position, 1.0);
	// object space to world space
	v_normal = normalize(transpose(inverse(mat3(worldMat))) * normal);
	// object space to object space
	v_texCoord = texCoord;
}
```

## 6. Scan Conversion

- A horizontal line of pixels is named a _scan line_

![image.png](/lecture-notes/CH07/rasterizer1.png)

- Bilinear interpolation(ì„ í˜• ë³´ê°„ì„ ë‘ ë‹¨ê³„ì— ê±¸ì³ì„œ í•¨, yì¶•ì„ ë”°ë¼ì„œ&xì¶•ì„ ë”°ë¼ì„œ)-along the edges first, and then along the scan lines

## 7. Normal Interpolation

![image.png](/lecture-notes/CH07/rasterizer2.png)

fragment shader: ë³´ê°„ëœ normalê³¼ ë³´ê°„ëœ texture coordinatesë¥¼ ì´ìš©í•´ í”½ì…€ì˜ ìƒ‰ìƒ ê²°ì •.
